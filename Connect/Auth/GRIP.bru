meta {
  name: GRIP
  type: http
  seq: 2
}

post {
  url: {{AZURE_TENANT_URL}}/{{AZURE_TENANT_ID}}/oauth2/v2.0/token
  body: formUrlEncoded
  auth: none
}

headers {
  content-type: application/x-www-form-urlencoded
}

body:form-urlencoded {
  grant_type: client_credentials
  scope: {{GRIP_SCOPE}}/.default
  client_id: {{GRIP_CLIENT_ID}}
  client_secret: {{GRIP_CLIENT_SECRET}}
}

script:post-response {
  bru.setVar('GRIP_BEARER',res.body.access_token);
}
